<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ø§Ø¯Ø© â€” {{ subject.name }} (Ø§Ù„Ø³Ù†Ø© {{ term.year }} / Ø§Ù„ÙØµÙ„ {{ term.get_number_display }})</title>
  <style>
    :root { --bg:#fff; --bd:#e7e7e7; --ink:#111; --muted:#666; --pill:#eef; --pillbd:#dde; }
    body{font-family:system-ui,Tahoma; margin:2rem; color:var(--ink); background:var(--bg); }
    .head{display:flex; justify-content:space-between; align-items:center; gap:1rem; flex-wrap:wrap}
    .badge{display:inline-block; background:var(--pill); border:1px solid var(--pillbd); padding:.25rem .6rem; border-radius:8px; font-size:.9rem; margin-inline-end:.25rem}
    .btn{padding:.5rem .8rem; border-radius:10px; border:1px solid #ccc; text-decoration:none; display:inline-block; cursor:pointer; background:#fff}
    .btn:hover{background:#f7f7f7}
    .card{border:1px solid var(--bd); border-radius:14px; padding:1rem; background:#fff}
    h1{margin:.6rem 0 0 0}
    .toolbar{display:flex; gap:.6rem; flex-wrap:wrap; align-items:center; margin:.8rem 0}
    .inp{width:280px; max-width:100%; padding:.55rem .7rem; border:1px solid #ccc; border-radius:10px}
    .grid{display:grid; gap:.8rem; grid-template-columns:1fr}
    @media(min-width:880px){ .grid{grid-template-columns:1fr 1fr} }
    .lesson{border:1px solid var(--bd); border-radius:12px; padding:.9rem; display:flex; flex-direction:column; gap:.45rem}
    .lesson__meta{font-size:.9rem; color:var(--muted); display:flex; gap:.6rem; flex-wrap:wrap}
    .lesson__title{font-weight:700}
    .lesson__actions{margin-top:.4rem; display:flex; gap:.5rem; flex-wrap:wrap}
    .empty{color:var(--muted); padding:1rem 0}
  </style>
</head>
<body>
  <div class="head">
    <div>
      <span class="badge">Ø§Ù„Ø³Ù†Ø©: {{ term.year }}</span>
      <span class="badge">Ø§Ù„ÙØµÙ„: {{ term.get_number_display }}</span>
      <span class="badge">Ø§Ù„Ù…Ø§Ø¯Ø©: {{ subject.name }}</span>
    </div>
    <div>
      <a class="btn" href="{% url 'subjects_grid' term.id %}">â¬… Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù…ÙˆØ§Ø¯</a>
    </div>
  </div>

  <h1>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø±ÙˆØ³</h1>

  <div class="toolbar">
    <input class="inp" id="search" type="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¯Ø±Ø³ Ø¨Ø§Ù„Ø¹Ù†ÙˆØ§Ù†..." aria-label="Ø¨Ø­Ø«" />
  </div>

  <section class="card">
    {% if lessons %}
      <div class="grid" id="lessonsGrid">
        {% for lesson in lessons %}
          <article class="lesson" data-title="{{ lesson.title|lower }}">
            <div class="lesson__title">ğŸ“˜ {{ lesson.title }}</div>
            <div class="lesson__meta">
              <span>Ø§Ù„Ù…Ø¹Ø±Ù: {{ lesson.id }}</span>
              {% if lesson.content and lesson.content.body %}
                <span>Ø§Ù„Ù…Ø­ØªÙˆÙ‰: Ù…ÙˆØ¬ÙˆØ¯</span>
              {% else %}
                <span>Ø§Ù„Ù…Ø­ØªÙˆÙ‰: ØºÙŠØ± Ù…ØªÙˆÙØ±</span>
              {% endif %}
            </div>
            <div class="lesson__actions">
              <a class="btn" href="{% url 'lesson_detail' term.id subject.id lesson.id %}">ğŸ‘ï¸ Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø±Ø³</a>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯Ø±ÙˆØ³ Ø¨Ø¹Ø¯ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø©.</div>
    {% endif %}
  </section>

  <script>
    // ØªØµÙÙŠØ© Ø§Ù„Ø¯Ø±ÙˆØ³ Ø­Ø³Ø¨ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ø¹Ù…ÙŠÙ„ ÙÙ‚Ø·)
    const search = document.getElementById('search');
    const grid   = document.getElementById('lessonsGrid');
    search?.addEventListener('input', () => {
      const q = (search.value || '').trim().toLowerCase();
      if (!grid) return;
      [...grid.children].forEach(card => {
        const title = card.getAttribute('data-title') || '';
        card.style.display = title.includes(q) ? '' : 'none';
      });
    });
  </script>
</body>
</html>
